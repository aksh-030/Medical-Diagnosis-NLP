Unclean, original code for reference.
